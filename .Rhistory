layout(title = "Class 8")
head(apply(x_train[,-1], 1, mean))
head(apply(x_train[,-1], 1, sd))
head(apply(y_train[,-1], 1, mean))
head(apply(y_train[,-1], 1, sd))
head(apply(z_train[,-1], 1, mean))
head(apply(z_train[,-1], 1, sd))
knitr::opts_chunk$set(echo = TRUE, message=FALSE, fig.align = "center")
library(tidyverse)
library(kableExtra)
library(RColorBrewer)
library(ggExtra)
library(data.table)
library(patchwork)
library(plotly)
preparation <- function(from, ax){
data = fread(from)
columns = c("class", paste(paste(ax, 'T', sep = ''), 1:(ncol(data)-1), sep = ''))
colnames(data) = columns
data
}
transformation <- function(data, ax){
data = data[, "time series" := 1:nrow(data)]
data_long = gather(data, "time index", val, paste(ax, 'T1', sep = ''):paste(ax, 'T315', sep = ''))
colnames(data_long)[4] = ax
data_long[,3] = unlist(lapply(data_long[,3], function(x){as.numeric(substring(x, 3, length(x) + 4))}))
data_long = data_long[order(data_long[,2], data_long[,3]),]
as.data.table(data_long)
}
position <- function(data, ax){
x = data[data[, .I[3], by = class]$V1][, -1]
y = t(x)
y = y[,order(data[data[, .I[3], by = class]$V1][, class])]
y = cbind(y, apply(y, 2, cumsum))
y = cbind(y, apply(y[,9:16], 2, cumsum))
colnames(y) = c(paste(ax, 1:8, sep = "_"), paste("vel", 1:8, sep = "_"), paste("position", 1:8, sep = "_"))
y
}
pca_plot <- function(value){
series = unlist(unique(x_train_long[class == value, 2]))
set.seed(3295)
randoms = sample(series, 2)
plot_data <- data_long[`time series` %in% randoms,]
plot_data[,1] <- apply(plot_data[,1], 2, as.character)
ggplot(plot_data, aes(x = `time index`, y = PCA1, color = `time series`)) +
geom_point() +
labs(title = paste("1D Representation of Data For Gesture Class", value, sep = ' '),
x = "Time Index",
y = "First Component")
}
pca_class <- function(value){
data = data_long[data_long$class == value,]
pca = princomp(data[, 3:5], cor = T)
summary(pca, loadings=T)
}
x_train <- preparation("https://drive.google.com/uc?export=download&id=1KDhDT0FE5lkjvn62YTCJ87vZ7A5uS5TT", "X")
y_train <- preparation("https://drive.google.com/uc?export=download&id=1fZCNBdJ40Df5werSu_Ud4GUmCBcBIfaI", "Y")
z_train <- preparation("https://drive.google.com/uc?export=download&id=1jdZ2_NiFil0b4EbLBAfDJ43VQcOgulpf", "Z")
data_wide <- cbind(x_train, y_train[, 2:ncol(y_train)], z_train[, 2:ncol(z_train)])
x_train_long <- transformation(x_train, 'X')
y_train_long <- transformation(y_train, 'Y')
z_train_long <- transformation(z_train, 'Z')
data_long <- x_train_long %>%
left_join(y_train_long, by = c("time series", "time index", "class")) %>%
left_join(z_train_long, by = c("time series", "time index", "class"))
data_long <- data_long[, c(2, 3, 4, 5, 6, 1)]
head(x_train, 50) %>% select(class, XT1, XT2, XT3 , XT4, XT5, XT6 , XT7, XT8, XT9 , XT10)%>%
kable(col.names = c("Class","X Train 1","X Train 2", "X Train 3", "X Train 4","X Train 5","X Train 6","X Train 7","X Train 8","X Train 9","X Train 10"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(y_train, 50) %>% select(class, YT1, YT2, YT3 , YT4, YT5, YT6 , YT7, YT8, YT9 , YT10)%>%
kable(col.names = c("Class","Y Train 1","Y Train 2", "Y Train 3", "Y Train 4","Y Train 5","Y Train 6","Y Train 7","Y Train 8","Y Train 9","Y Train 10"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(z_train, 50) %>% select(class, ZT1, ZT2, ZT3 , ZT4, ZT5, ZT6 , ZT7, ZT8, ZT9 , ZT10)%>%
kable(col.names = c("Class","Z Train 1","Z Train 2", "Z Train 3", "Z Train 4","Z Train 5","Z Train 6","Z Train 7","Z Train 8","Z Train 9","Z Train 10"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(data_wide, 50) %>% select(class, XT1, XT2, XT3 , XT4, XT5, XT6 , XT7, XT8, XT9 , XT10, YT1, YT2, YT3 , YT4, YT5, YT6 , YT7, YT8, YT9 , YT10, ZT1, ZT2, ZT3 , ZT4, ZT5, ZT6 , ZT7, ZT8, ZT9 , ZT10)%>%
kable(col.names = c("Class","X Train 1","X Train 2", "X Train 3", "X Train 4","X Train 5","X Train 6","X Train 7","X Train 8","X Train 9","X Train 10", "Y Train 1","Y Train 2", "Y Train 3", "Y Train 4","Y Train 5","Y Train 6","Y Train 7","Y Train 8","Y Train 9","Y Train 10", "Z Train 1","Z Train 2", "Z Train 3", "Z Train 4","Z Train 5","Z Train 6","Z Train 7","Z Train 8","Z Train 9","Z Train 10"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(x_train_long, 50) %>% select(class, "time series" , "time index" , X)%>%
kable(col.names = c("Class","Time Series","Time Index", "X"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(y_train_long, 50) %>% select(class, "time series" , "time index" , Y)%>%
kable(col.names = c("Class","Time Series","Time Index", "Y"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(z_train_long, 50) %>% select(class, "time series" , "time index" , Z)%>%
kable(col.names = c("Class","Time Series","Time Index", "Z"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
head(data_long, 50) %>% select("time series" , "time index" , X, Y, Z, class)%>%
kable(col.names = c("Time Series","Time Index", "X", "Y", "Z", "Class"))%>%
kable_styling("striped", "condensed", font_size = 13) %>%
scroll_box(width = "100%", height = "500px")
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers") %>%
layout(title = "Class 1")
plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers") %>%
layout(title = "Class 2")
plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers") %>%
layout(title = "Class 3")
plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers") %>%
layout(title = "Class 4")
plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers") %>%
layout(title = "Class 5")
plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",) %>%
layout(title = "Class 6")
plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers") %>%
layout(title = "Class 7")
plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers") %>%
layout(title = "Class 8")
head(apply(x_train[,-1], 1, mean))
head(apply(x_train[,-1], 1, sd))
head(apply(y_train[,-1], 1, mean))
head(apply(y_train[,-1], 1, sd))
head(apply(z_train[,-1], 1, mean))
head(apply(z_train[,-1], 1, sd))
pca <- princomp(data_long[,3:5], cor = T)
summary(pca, loadings=T)
data_long[, PCA1 := pca$scores[,1]]
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter", mode="markers")
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")%>%
theme_plotly()
pca_plot(1)
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")
pca_plot(2)
plot_ly(x = x_coord[,"X_2"], y = y_coord[,"Y_2"], z = z_coord[,"Z_2"], type="scatter3d", mode="markers")
pca <- princomp(data_long[,3:5], cor = T)
summary(pca, loadings=T)
data_long[, PCA1 := pca$scores[,1]]
pairsplot(pca)
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")
scale_colour_gradient(low = 'gold', high = 'red2')
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")
+ scale_colour_gradient(low = 'gold', high = 'red2')
pca_plot(1)+ scale_colour_gradient(low = 'gold', high = 'red2')
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode='lines+markers')
pca_plot(1)
plot_ly(x = x_coord[,"X_1"], y = y_coord[,"Y_1"], z = z_coord[,"Z_1"], type="scatter3d", mode="markers")
pca_plot(2)
plot_ly(x = x_coord[,"X_2"], y = y_coord[,"Y_2"], z = z_coord[,"Z_2"], type="scatter3d", mode="markers")
pca_plot(3)
plot_ly(x = x_coord[,"X_3"], y = y_coord[,"Y_3"], z = z_coord[,"Z_3"], type="scatter3d", mode="markers")
pca_plot(1)
pca_plot(2)
pca_plot(1)
pca_plot(2)
pca_plot(1)
pca_plot(2)
pca_plot(1)
pca_plot(2)
pca_plot(3)
pca_plot(4)
pca_plot(5)
pca_plot(6)
pca_plot(7)
pca_plot(8)
pca_plot(1)
pca_plot(2)
pca_plot(3)
pca_plot(4)
pca_plot(5)
pca_plot(6)
pca_plot(7)
pca_plot(8)
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers") %>%
layout(title = "Class 1")
plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers") %>%
layout(title = "Class 2")
plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers") %>%
layout(title = "Class 3")
plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers") %>%
layout(title = "Class 4")
plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers") %>%
layout(title = "Class 5")
plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",) %>%
layout(title = "Class 6")
plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers") %>%
layout(title = "Class 7")
plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers") %>%
layout(title = "Class 8")
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers") %>%
layout(title = "Class 1")
plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers") %>%
layout(title = "Class 2")
plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers") %>%
layout(title = "Class 3")
plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers") %>%
layout(title = "Class 4")
plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers") %>%
layout(title = "Class 5")
plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",) %>%
layout(title = "Class 6")
plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers") %>%
layout(title = "Class 7")
plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers") %>%
layout(title = "Class 8")
pca_class(1)
pca_class(2)
pca_class(3)
pca_class(4)
pca_class(5)
pca_class(6)
pca_class(7)
pca_class(8)
autoplot(long_form_pca, data = long_form, colour = "class",
loadings = TRUE, loadings.colour = 'blue',
loadings.label = TRUE, loadings.label.size = 3)
autoplot(data_long, data = long_form, colour = "class",
loadings = TRUE, loadings.colour = 'blue',
loadings.label = TRUE, loadings.label.size = 3)
x_train_distance = as.matrix(dist(x_train[, 2:316], method = 'manhattan'))
y_train_distance = as.matrix(dist(y_train[, 2:316], method = 'manhattan'))
z_train_distance = as.matrix(dist(z_train[, 2:316], method = 'manhattan'))
data_distance = x_train_distance + y_train_distance + z_train_distance
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) +
geom_point() +
labs(title = "Result of the MDS Process",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) +   scale_fill_brewer(palette="Pastel1")+  theme(axis.text.x = element_text(angle=65, vjust=0.6)) +
theme_minimal()+
geom_point() +
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) +   scale_fill_brewer(palette="Dark2")+  theme(axis.text.x = element_text(angle=65, vjust=0.6)) +
theme_minimal()+
geom_point() +
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) +   scale_fill_brewer(palette="Set1")+  theme(axis.text.x = element_text(angle=65, vjust=0.6)) +
theme_minimal()+
geom_point() +
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) + theme(axis.text.x = element_text(angle=65, vjust=0.6)) +
theme_minimal()+
geom_point() +
scale_fill_brewer(palette="Set1")+
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) + geom_point() + theme_minimal()+ theme(axis.text.x = element_text(angle=65, vjust=0.6))+
scale_color_brewer(palette="Set1")+
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) + geom_point() + theme_minimal()+ theme(axis.text.x = element_text(angle=65, vjust=0.6))+
scale_color_brewer(palette="Dark2")+
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
ggplot(mds, aes(x = D1, y = D2, color = class)) + geom_point() + theme_minimal()+ theme(axis.text.x = element_text(angle=65, vjust=0.6))+
scale_color_brewer(palette="Set1")+
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=2, margin=0.05)
fig
subplot(p1, p2, p1, p2, nrows = 2, margin = 0.05)
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=2, margin=0.05)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=8)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=8)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=8)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=8, shareX = TRUE)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=8, shareX = TRUE)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
a <-plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers",  scene='scene1') %>%
layout(title = "Class 1")
b <-plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers",  scene='scene2') %>%
layout(title = "Class 2")
c <-plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers",  scene='scene3') %>%
layout(title = "Class 3")
d <-plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers",  scene='scene4') %>%
layout(title = "Class 4")
e <-plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers",  scene='scene5') %>%
layout(title = "Class 5")
f <-plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",  scene='scene6') %>%
layout(title = "Class 6")
g <-plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers",  scene='scene7') %>%
layout(title = "Class 7")
h <-plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers",  scene='scene8') %>%
layout(title = "Class 8")
fig <- subplot(a, b,c,d,e,f,g,h, nrows=8)
fig
x_coord <- position(x_train, 'X')
y_coord <- position(y_train, 'Y')
z_coord <- position(z_train, 'Z')
plot_ly(x = x_coord[,"position_1"], y = y_coord[,"position_1"], z = z_coord[,"position_1"], type="scatter3d", mode="markers") %>%
layout(title = "Class 1")
plot_ly(x = x_coord[,"position_2"], y = y_coord[,"position_2"], z = z_coord[,"position_2"], type="scatter3d", mode="markers") %>%
layout(title = "Class 2")
plot_ly(x = x_coord[,"position_3"], y = y_coord[,"position_3"], z = z_coord[,"position_3"], type="scatter3d", mode="markers") %>%
layout(title = "Class 3")
plot_ly(x = x_coord[,"position_4"], y = y_coord[,"position_4"], z = z_coord[,"position_4"], type="scatter3d", mode="markers") %>%
layout(title = "Class 4")
plot_ly(x = x_coord[,"position_5"], y = y_coord[,"position_5"], z = z_coord[,"position_5"], type="scatter3d", mode="markers") %>%
layout(title = "Class 5")
plot_ly(x = x_coord[,"position_6"], y = y_coord[,"position_6"], z = z_coord[,"position_6"], type="scatter3d", mode="markers",) %>%
layout(title = "Class 6")
plot_ly(x = x_coord[,"position_7"], y = y_coord[,"position_7"], z = z_coord[,"position_7"], type="scatter3d", mode="markers") %>%
layout(title = "Class 7")
plot_ly(x = x_coord[,"position_8"], y = y_coord[,"position_8"], z = z_coord[,"position_8"], type="scatter3d", mode="markers") %>%
layout(title = "Class 8")
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
plot<-ggplot(mds, aes(x = D1, y = D2, color = class)) + geom_point() + theme_minimal()+ theme(axis.text.x = element_text(angle=65, vjust=0.6))+
scale_color_brewer(palette="Set1")+
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
plot + facet_wrap(~class)
mds <- cmdscale(data_distance, k=2)
mds <- data.table(unlist(apply(x_train[, 1], 2, as.character)), D1 = mds[,1], D2 = mds[,2])
plot<-ggplot(mds, aes(x = D1, y = D2, color = class)) + geom_point() + theme_minimal()+ theme(axis.text.x = element_text(angle=65, vjust=0.6))+
scale_color_brewer(palette="Set1")+
labs(title = "Multidimensional Scaling",
subtitle = "Gesture dataset",
x = "First Dimension",
y = "Second Dimension")
plot
plot + facet_wrap(~class)
